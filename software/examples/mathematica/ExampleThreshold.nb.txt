Needs["NETLink`"]
LoadNETAssembly["Tinkerforge",NotebookDirectory[]<>"../../.."]

host="localhost"
port=4223
uid="sad"(* Change to your UID *)

(* Create IPConnection and device object *)
ipcon=NETNew["Tinkerforge.IPConnection"]
acc=NETNew["Tinkerforge.BrickletAccelerometer",uid,ipcon]
ipcon@Connect[host,port]

(* Get threshold callbacks with a debounce time of 10 seconds (10000ms) *)
acc@SetDebouncePeriod[10000]

(* Callback for acceleration threshold reached *)
AccelerationReachedCB[sender_,x_,y_,z_]:=
 Module[{},
  Print["Acceleration(X): "<>ToString[N[Quantity[x,"mg"]]]];
  Print["Acceleration(Y): "<>ToString[N[Quantity[y,"mg"]]]];
  Print["Acceleration(Z): "<>ToString[N[Quantity[z,"mg"]]]]
 ]

AddEventHandler[acc@AccelerationReached,AccelerationReachedCB]

(* Configure threshold for acceleration values X, Y or Z "greater than 2g" (unit is g/1000) *)
option=Tinkerforge`BrickletAccelerometer`THRESHOLDUOPTIONUGREATER
acc@SetAccelerationCallbackThreshold[option,2*1000,0,2*1000,0,2*1000,0]

Input["Click OK to exit"]

(* Clean up *)
ipcon@Disconnect[]
ReleaseNETObject[acc]
ReleaseNETObject[ipcon]
